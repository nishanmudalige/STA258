# One Sample Hypothesis Test on a Proportion and Variance

Inferential statistics is a powerful method for statistical analysis,
because it allows people to analyze a lot parameters. Similarly to
confidence interval, testing hypothesis can be applied to proportion and
variance as well. Also, we use the exact same structure for one sample
hypothesis test on a proportion and variance.

## One Sample Hypothesis Test on a Proportion

Suppose we have assume the proportion of a criteria from a population
$p$ is equal to our parameter $p_0$ (null hypothesis $H_0: p = p_0$).
While, the question is: how do we know whether our assumption is correct
or not? We need to use testing hypothesis on proportion to verify.\
**Step 1. Stating the Structure of Testing Hypothesis**

First of all, let's proceed with a table to see all the cases:

::: center
<figure>
<table>
<tbody>
<tr>
<td style="text-align: center;">Cases</td>
<td style="text-align: center;">Null Hypothesis</td>
<td style="text-align: center;">Alternative Hypothesis</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub>0</sub> : <em>p</em> = <em>p</em><sub>0</sub></span></td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub><em>a</em></sub> : <em>p</em> &gt; <em>p</em><sub>0</sub></span></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub>0</sub> : <em>p</em> = <em>p</em><sub>0</sub></span></td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub><em>a</em></sub> : <em>p</em> &lt; <em>p</em><sub>0</sub></span></td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub>0</sub> : <em>p</em> = <em>p</em><sub>0</sub></span></td>
<td style="text-align: center;"><span
class="math inline"><em>H</em><sub><em>a</em></sub> : <em>p</em> ≠ <em>p</em><sub>0</sub></span></td>
</tr>
</tbody>
</table>
<figcaption>All possible cases of one sample hypothesis test on a
proportion (<span class="math inline"><em>p</em></span> represents the
actual proportion of a population)</figcaption>
</figure>
:::

We are not going to proceed with all three cases in a single question.
You need to be able to identify which case of testing hypothesis are
going to be applied from question.\
**Step 2. Computing Test Statistics**

After that we need to compute our test statistics, as the following
definition provides:

::: definition
The test statistics of one sample hypothesis test on a proportion is
given by:
$$Z^* = Z^* = \frac{\hat{p} - p_0}{ \sqrt{ \frac{p_0(1-p_0)}{n} } }.$$
In this case, $n$ means the sample size, $\hat{p}$ is the parameter of
the proportion of the population, which is calculated by
$\hat{p} = \frac{\text{number of successes in the sample}}{n}$. Also,
the reference distribution is standard normal distribution: $N(0,1)$.
:::

Note that be careful while you are computing the test statistics,
because it directly affects the final answer.\
**Step 3. Finding the $p$ - value**

i\. When is structure of testing hypothesis is $H_0: p = p_0$,
$H_a: p > p_0$:

```{r fig.align='center', echo=FALSE, engine='tikz', out.width='90%', fig.ext=if (knitr::is_latex_output()) 'pdf' else 'png', fig.cap='An illustration of hypothesis test on a proportion that $H_0: p = p_0$, $H_a: p > p_0$.'}
\usetikzlibrary{decorations.pathmorphing, arrows, shapes, trees, positioning, matrix, calc, backgrounds}
\begin{tikzpicture}[xscale=2.5, yscale=8]

  % Define normal curve function
  \def\normpdf{\x,{0.39894*exp(-0.5*\x*\x)}}

  % Axes
  \draw[->, thick] (-3.2,0) -- (3.3,0) node[below right] {$x$};

  % Vertical line from mean to peak
  \draw[thin] (0,0) -- (0,0.39894);
  \draw[->, thin] (0,0.39894) -- ++(0,0.01);

  % Draw right tail shading (p-value)
  \fill[blue, opacity=0.3]
    (1.2,0)
    -- plot[domain=1.2:3.1, samples=100] (\x,{0.39894*exp(-0.5*\x*\x)})
    -- (3.1,0) -- cycle;

  % Curve
  \draw[very thick, blue, domain=-3.1:3.1, samples=200]
    plot (\normpdf);

  % Vertical line at Z*
  \draw[thin] (1.2,0) -- (1.2,{0.39894*exp(-0.5*1.2*1.2)});

  % Labels
  \node at (2.1, 0.2) {P-value};
  \node at (1.2, -0.025) {$Z^*$};

\end{tikzpicture}
```

In case (i), calculating $P[Z > Z_*]$ as your p-value. Then, comparing
with significant level: $\alpha$.

ii\. When is structure of testing hypothesis is $H_0: p = p_0$,
$H_a: p < p_0$:

```{r fig.align='center', echo=FALSE, engine='tikz', out.width='90%', fig.ext=if (knitr::is_latex_output()) 'pdf' else 'png', fig.cap='An illustration of hypothesis test on a proportion that $H_0: p = p_0$, $H_a: p < p_0$.'}
\usetikzlibrary{decorations.pathmorphing, arrows, shapes, trees, positioning, matrix, calc, backgrounds}
\begin{tikzpicture}[xscale=2.5, yscale=8]

  % Define normal curve
  \def\normpdf{\x,{0.39894*exp(-0.5*\x*\x)}}

  % x-axis
  \draw[->, thick] (-3.2,0) -- (3.3,0) node[below right] {$x$};

  % Peak line
  \draw[thin] (0,0) -- (0,0.39894);
  \draw[->, thin] (0,0.39894) -- ++(0,0.01);

  % Left-tail fill (P-value)
  \fill[blue, opacity=0.3]
    (-3.1,0)
    -- plot[domain=-3.1:1.2, samples=100] (\x,{0.39894*exp(-0.5*\x*\x)})
    -- (1.2,0) -- cycle;

  % Normal curve
  \draw[very thick, blue, domain=-3.1:3.1, samples=200]
    plot (\normpdf);

  % Vertical line at Z*
  \draw[thin] (1.2,0) -- (1.2,{0.39894*exp(-0.5*1.2*1.2)});

  % Labels
  \node at (-1.6, 0.18) {P-value};
  \node at (1.2, -0.025) {$Z^*$};

\end{tikzpicture}
```

In case (ii), calculating $P[Z < Z_*]$ as your p-value. Then, comparing
with significant level: $\alpha$.

iii\. When is structure of testing hypothesis is $H_0: p = p_0$,
$H_a: p \neq p_0$:

```{r fig.align='center', echo=FALSE, engine='tikz', out.width='90%', fig.ext=if (knitr::is_latex_output()) 'pdf' else 'png', fig.cap='An illustration of hypothesis test on a proportion that $H_0: p = p_0$, $H_a: p \\neq p_0$.'}
\usetikzlibrary{decorations.pathmorphing, arrows, shapes, trees, positioning, matrix, calc, backgrounds}
\begin{tikzpicture}[xscale=2.5, yscale=8]

  % Normal curve definition
  \def\normpdf{\x,{0.39894*exp(-0.5*\x*\x)}}

  % x-axis
  \draw[->, thick] (-3.2,0) -- (3.3,0) node[below right] {$x$};

  % Vertical line at center
  \draw[thin] (0,0) -- (0,0.39894);
  \draw[->, thin] (0,0.39894) -- ++(0,0.01);

  % Left-tail fill
  \fill[blue, opacity=0.3]
    (-3.1,0)
    -- plot[domain=-3.1:-1.2, samples=100] (\x,{0.39894*exp(-0.5*\x*\x)})
    -- (-1.2,0) -- cycle;

  % Right-tail fill
  \fill[blue, opacity=0.3]
    (1.2,0)
    -- plot[domain=1.2:3.1, samples=100] (\x,{0.39894*exp(-0.5*\x*\x)})
    -- (3.1,0) -- cycle;

  % Curve
  \draw[very thick, blue, domain=-3.1:3.1, samples=200]
    plot (\normpdf);

  % Vertical lines at Z* and -Z*
  \draw[thin] (1.2,0) -- (1.2,{0.39894*exp(-0.5*1.2*1.2)});
  \draw[thin] (-1.2,0) -- (-1.2,{0.39894*exp(-0.5*1.2*1.2)});

  % Labels
  \node at (-2.0, 0.2) {$\frac{1}{2}$ p-value};
  \node at (2.0, 0.2) {$\frac{1}{2}$ p-value};
  \node at (-1.2, -0.025) {$-Z^*$};
  \node at (1.2, -0.025) {$Z^*$};

\end{tikzpicture}
```

In case (iii), calculating $2\cdot P[Z > |Z_*|]$ as your p-value. Then,
comparing with significant level: $\alpha$.\
**Step 4: Comparing P-value with $\alpha$-level**

If p-value is less than $\alpha$-level, then we reject the null
hypothesis ($H_0$) and accept the alternative hypothesis ($H_a$).
Otherwise, If p-value is greater than $\alpha$-level, then we do not
reject the null hypothesis ($H_0$) and reject the alternative hypothesis
($H_a$).\
**Step 5: Final Conclusion** If we reject the null hypothesis, then we
conclude that: there is sufficient evidence to reject the null
hypothesis. If we do not reject the null hypothesis, then we conclude
that: there is insufficient evidence to reject the null hypothesis.\
**Conditions on One Sample Test Hypothesis on a Proportion**

- 1\. Random sample;

- 2\. Independent sample: each observations are independent to others;

- 3\. Sufficient sample.

## One Sample Hypothesis Tests for a Variance

Now, let's move to hypothesis tests for one variance, which follows the exact same idea from testing hypotheses on proportions. We are going to introduce that using steps as well.

**Step 1: Stating the Structure of Testing Hypothesis**

```{r, echo=FALSE, results='asis'}
knitr::kable(
  data.frame(
    Cases = 1:3,
    `Null Hypothesis` = c("$H_0: \\sigma^2 = \\sigma_0^2$", "$H_0: \\sigma^2 = \\sigma_0^2$", "$H_0: \\sigma^2 = \\sigma_0^2$"),
    `Alternative Hypothesis` = c(
      "$H_a: \\sigma^2 > \\sigma_0^2$",
      "$H_a: \\sigma^2 < \\sigma_0^2$",
      "$H_a: \\sigma^2 \\neq \\sigma_0^2$"
    ),
    check.names = FALSE
  ),
  caption = "All possible cases of one sample hypothesis test on a variance",
  escape = FALSE
)
```

**Step 2: Computing Test Statistics**

::: {.definition}
**Test Statistic of One Sample Hypothesis Test on a Variance**  
The test statistic of one sample hypothesis test on a variance is given by:  
$$
\chi_*^2 = \frac{(n - 1)s^2}{\sigma_0^2} \sim \chi^2_{n - 1}
$$  
Note that $n$ represents the sample size, and $s^2$ is the sample variance of the chosen sample.
:::

**Step 3: Decision Rules**

- Case 1: $H_0: \sigma^2 = \sigma_0^2$ and $H_a: \sigma^2 \neq \sigma_0^2$ (two-tailed alternative).  
  Reject $H_0$ if $\chi_*^2 > \chi^2_{n-1;\alpha/2}$ or $\chi_*^2 < \chi^2_{n-1;1-\alpha/2}$.

- Case 2: $H_0: \sigma^2 = \sigma_0^2$ and $H_a: \sigma^2 > \sigma_0^2$ (upper-tailed).  
  Reject $H_0$ if $\chi_*^2 > \chi^2_{n-1;\alpha}$ or if $P[\chi^2_{n-1} > \chi_*^2]$ is too small.

- Case 3: $H_0: \sigma^2 = \sigma_0^2$ and $H_a: \sigma^2 < \sigma_0^2$ (lower-tailed).  
  Reject $H_0$ if $\chi_*^2 < \chi^2_{n-1;1-\alpha}$ or if $P[\chi^2_{n-1} < \chi_*^2]$ is too small.

Note: This test is **not robust** to departures from normality.

---

In case (i), where $H_0: p = p_0$ and $H_a: p > p_0$, calculate the p-value as $P[Z > Z_*]$, then compare with significance level $\alpha$.

In case (ii), where $H_0: p = p_0$ and $H_a: p < p_0$, calculate the p-value as $P[Z < Z_*]$, then compare with significance level $\alpha$.

In case (iii), where $H_0: p = p_0$ and $H_a: p \neq p_0$, calculate the p-value as $2 \cdot P[Z > |Z_*|]$, then compare with $\alpha$.

**Step 4: Comparing P-value with $\alpha$-level**

- If the p-value is **less than** $\alpha$, reject the null hypothesis ($H_0$).
- If the p-value is **greater than** $\alpha$, do not reject the null hypothesis ($H_0$).

**Step 5: Final Conclusion**

- If we reject $H_0$, we conclude there is **sufficient evidence** to reject the null hypothesis.
- If we do not reject $H_0$, we conclude there is **insufficient evidence** to reject the null hypothesis.

**Conditions for One Sample Hypothesis Test on a Proportion**

- Random sample;
- Independent observations;
- Sufficient sample size.
